# 🌀 문맥 교환 (Context Switch)

> 운영체제에서 **CPU가 여러 프로세스를 번갈아 실행할 때** 발생하는 중요한 개념

---

## ✅ 문맥 교환이란?

문맥 교환(Context Switch)이란 **CPU가 현재 실행 중인 프로세스(또는 스레드)의 상태(문맥)를 저장**하고,  
**다른 프로세스의 상태를 복원하여 실행을 전환하는 과정**을 말한다.

멀티태스킹 환경에서 CPU는 하나의 작업만 수행할 수 있기 때문에,  
다수의 프로세스가 CPU를 번갈아 사용하며 실행된다.  
이때 프로세스 간 전환을 위해 문맥(Context)을 저장하고 불러오는 작업이 필요하다.

---

## 🧠 문맥(Context)에 포함되는 정보

- **레지스터 상태**
- **프로그램 카운터 (Program Counter)**
- **스택 포인터**
- **프로세스 상태 (Running, Waiting 등)**
- **메모리 맵 정보 (페이지 테이블 등)**

---

## 🔁 문맥 교환의 과정

1. **현재 실행 중인 프로세스의 상태 저장 (PCB에 저장)**
2. **새로 실행할 프로세스의 상태(PCB)를 읽어옴**
3. **레지스터, PC 등 복원**
4. **CPU 제어를 새 프로세스에 넘김**

---

## 🚨 문맥 교환의 단점 (오버헤드)

- **자원 소비**: 저장/복원하는 작업이 CPU 시간과 메모리를 사용함
- **실행 지연**: 문맥 교환 시간이 많아지면 실제 작업 수행 시간은 줄어듦
- **캐시 무효화**: CPU 캐시와 메모리 매핑 정보가 초기화되어 성능 저하 발생

---

## 💡 문맥 교환이 자주 발생하는 경우

- **멀티태스킹 운영체제에서 타임 슬라이스 종료**
- **I/O 요청 등으로 프로세스가 블로킹되었을 때**
- **우선순위가 높은 프로세스가 준비 상태일 때**
- **시스템 호출이나 인터럽트 처리 시**

---

## 🆚 문맥 교환 vs 함수 호출

| 구분 | 문맥 교환 | 함수 호출 |
|------|-----------|------------|
| 대상 | 다른 프로세스/스레드 | 같은 프로세스 내 함수 |
| 비용 | 매우 높음 | 낮음 |
| 목적 | CPU 제어권 이동 | 코드 재사용 |
| 캐시 영향 | 있음 (무효화 가능) | 거의 없음 |

---

## ✅ 정리

문맥 교환은 **운영체제가 멀티태스킹을 지원하기 위해 필수적인 작업**이지만,  
**성능에 영향을 줄 수 있는 오버헤드**가 크기 때문에,  
운영체제는 문맥 교환을 **최대한 효율적으로 수행**하도록 설계된다.
